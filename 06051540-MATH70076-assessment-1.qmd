---
title: "06051540-MATH70076-assessment-1"
subtitle: 'MSc in Statistics 2025/26, Imperial College London'
author: "Justin Upson"
format:
  html:
    toc: true
    highlight: tango
    self-contained: true
    df-print: paged
  pdf: default
format-links: false
bibliography: ref.bib 
---

# Question 1

**For $\xi \neq 0$:** 

We know from the cumulative distribution function that:
\begin{equation}
  F(x;\sigma,\xi,u) = 1-\left(1+\frac{\xi(x-u)}{\sigma}\right)_+^{-1/\xi}
\end{equation}
Rewriting to make $x$ the subject:
\begin{align}
\left(1+\frac{\xi(x-u)}{\sigma}\right)_+^{-1/\xi}&=(1-F) \\
1&=(1-F)\left(1+\frac{\xi(x-u)}{\sigma}\right)_+^{1/\xi} \\
(1-F)^{-1}&=\left(1+\frac{\xi(x-u)}{\sigma}\right)_+^{1/\xi} \\
\end{align}
For $\xi > 0$, we see that $\left(1+\frac{\xi(x-u)}{\sigma}\right)^{1/\xi}>0$, so we get:
\begin{align}
(1-F)^{-\xi}&=1+\frac{\xi(x-u)}{\sigma} \\
(1-F)^{-\xi}-1&=\frac{\xi(x-u)}{\sigma} \\
\left(\left(1-F\right)^{-\xi}-1\right)\times \frac{\sigma}{\xi} &= x-u\\
u+\left(\left(1-F\right)^{-\xi}-1\right)\times \frac{\sigma}{\xi} &= x\\
\end{align}
So $F_X^{-1}=u+\left(\left(1-x\right)^{-\xi}-1\right)\times \frac{\sigma}{\xi}$
But given our inputs of $F_X^{-1}(x)$ vary between 0 and 1, we can write that:
\begin{equation}
F_X^{-1}(x)=u+\left(\left(x\right)^{-\xi}-1\right)\times \frac{\sigma}{\xi}
\end{equation}

For $\xi < 0$, we know that we have quickly decaying tails with finite upper endpoint. With $x>u$, this finite endpoint is met when
\begin{align}
1+\frac{\xi(x-u)}{\sigma}&=0 \\
\frac{\xi(x-u)}{\sigma}&=-1 \\
x-u&=-\frac{\sigma}{\xi} \\
x&=u-\frac{\sigma}{\xi} \\
\end{align}
So for $x > u-\frac{\sigma}{\xi}$, produced by the inverse function above we discard the values of $x$.

**For $\xi = 0$:**
\begin{align}
F&=1-exp\left(-\frac{x-u}{\sigma}\right) \\
exp\left(-\frac{x-u}{\sigma}\right)&=1-F \\
-\frac{x-u}{\sigma}&=ln(1-F) \\
-x+u&=\sigma ln(1-F) \\
u-\sigma ln(1-F) &= x \\
\end{align}
So $F_X^{-1}=u-\sigma ln(1-x)$

But given our inputs of $F_X^{-1}(x)$ vary between 0 and 1, we can write that:
\begin{equation}
F_X^{-1}(x)=u-\sigma ln(x)
\end{equation}

# Question 2a

Defining the quantile function, and using the basis of the cdf from question 1, we get that:
```{r}
qgpd <- function (p, sigma=1, xi=0, u=0){
  if (xi != 0){
    return(u + ((1-p)^(-xi)-1) * sigma / xi)
  } else {
    return(u - sigma * log(1-p))
  }
}
```

By default, the expected inputs for the function are sigma=1, xi=0, u=0. 

The expected output is a real number greater than u that is unbounded if xi is greater than or equal to 0. The expected output is less than u - sigma/xi if xi is less than 0.

The behaviours of the quantile function varies depending on the parameters:
We do not have any values less than u.


**TO FILL IN**
**ADD IN EDGE CASES (THE LIMIT WHEN XI < 0)**

# Question 2b

```{r}
qgpd(0.5,2,-0.4,1.5)
qgpd(0.75,2,-0.4,1.5)
qgpd(0.99,2,-0.4,1.5)
```

---

